---
/**
 * @component Contact
 *
 * @description
 * Contact 组件用于展示企业或个人的联系信息，支持多种联系方式（邮件、电话、地址）和社交媒体链接。
 * 组件设计简洁专业，适合在企业网站的联系页面、页脚或关于我们页面中使用。
 * 现在基于 Card 组件重构，提供更好的动画效果和一致性。
 *
 * @usage
 * 基本用法：
 * ```astro
 * <Contact
 *   email="contact@company.com"
 *   phone="+1 (555) 123-4567"
 *   address="123 Business St, City, State 12345"
 * />
 * ```
 *
 * 带社交媒体链接：
 * ```astro
 * <Contact
 *   email="contact@company.com"
 *   phone="+1 (555) 123-4567"
 *   address="123 Business St, City, State 12345"
 *   github="https://github.com/company"
 *   twitter="https://twitter.com/company"
 *   facebook="https://facebook.com/company"
 * />
 * ```
 *
 * 带标题和描述：
 * ```astro
 * <Contact
 *   title="联系我们"
 *   description="欢迎随时与我们取得联系"
 *   email="contact@company.com"
 *   phone="+1 (555) 123-4567"
 * />
 * ```
 *
 * 紧凑模式：
 * ```astro
 * <Contact
 *   email="contact@company.com"
 *   phone="+1 (555) 123-4567"
 *   compact
 * />
 * ```
 *
 * 自定义背景色：
 * ```astro
 * <Contact
 *   title="联系我们"
 *   description="欢迎随时与我们取得联系"
 *   email="contact@company.com"
 *   phone="+1 (555) 123-4567"
 *   background="primary/10"
 * />
 * ```
 *
 * 添加微信和 WhatsApp 二维码：
 * ```astro
 * <Contact
 *   title="联系我们"
 *   description="欢迎随时与我们取得联系"
 *   email="contact@company.com"
 *   phone="+1 (555) 123-4567"
 *   wechatQR="/images/wechat-qr.png"
 *   whatsappQR="/images/whatsapp-qr.png"
 * />
 * ```
 *
 * 使用本地图片作为二维码：
 * ```astro
 * import wechatQR from '/images/wechat-qr.png';
 * import whatsappQR from '/images/whatsapp-qr.png';
 * <Contact
 *   title="联系我们"
 *   email="contact@company.com"
 *   wechatQR={wechatQR}
 *   whatsappQR={whatsappQR}
 * />
 * ```
 *
 *
 * @props
 * @param {string} [address] - 地址信息
 * @param {BackgroundColor} [background] - 背景色类型，支持所有预设背景色和透明度变体
 * @param {string} [class] - 自定义CSS类，可用于覆盖默认样式
 * @param {boolean} [compact] - 是否使用紧凑模式
 * @param {string} [description] - 联系信息描述
 * @param {string} [email] - 电子邮件地址
 * @param {string} [facebook] - Facebook链接
 * @param {string} [github] - GitHub链接
 * @param {string} [linkedin] - LinkedIn链接
 * @param {string} [phone] - 电话号码
 * @param {string} [title] - 联系信息标题
 * @param {string} [twitter] - Twitter链接
 * @param {string} [website] - 网站链接
 * @param {ImageSource} [wechatQR] - 微信二维码图片源，支持本地图片或远程URL
 * @param {ImageSource} [whatsappQR] - WhatsApp 二维码图片源，支持本地图片或远程URL
 *
 * @slots
 * @slot default - 额外的联系信息内容
 */

import '../../style.ts';
import Card from '../card/Card.astro';
import Link from '../link/Link.astro';
import { type BackgroundColor } from '../../src/common/backgrounds';
import {
    FacebookIcon,
    GithubIcon,
    LinkedinIcon,
    MailIcon,
    MapPinIcon,
    PhoneIcon,
    TwitterIcon,
    WebsiteIcon,
    WechatIcon,
    WhatsappIcon,
} from '../icons/index.ts';

export interface ContactProps {
    address?: string;
    background?: BackgroundColor;
    class?: string;
    compact?: boolean;
    description?: string;
    email?: string;
    facebook?: string;
    github?: string;
    linkedin?: string;
    phone?: string;
    title?: string;
    twitter?: string;
    website?: string;
    wechatQR?: any; // ImageSource 类型
    whatsappQR?: any; // ImageSource 类型
}

const {
    address,
    background,
    class: className = '',
    compact,
    description,
    email,
    facebook,
    github,
    linkedin,
    phone,
    title,
    twitter,
    website,
    wechatQR,
    whatsappQR,
} = Astro.props as ContactProps;

// 构建自定义样式类（用于覆盖Card组件的默认样式）
const customClasses = [
    'cosy:shadow-lg',
    'hover:cosy:shadow-xl',
    'hover:cosy:bg-base-200',
    className,
]
    .filter(Boolean)
    .join(' ');

// 联系信息项的样式
const contactItemClass =
    'cosy:flex cosy:items-center cosy:gap-3 cosy:mb-4 last:cosy:mb-0 cosy:transition-all cosy:duration-200 cosy:ease-in-out hover:cosy:bg-base-200/50 hover:cosy:rounded-lg hover:cosy:p-2 hover:cosy:-mx-2';
const iconClass =
    'cosy:w-5 cosy:h-5 cosy:text-primary cosy:flex-shrink-0 cosy:transition-all cosy:duration-200 hover:cosy:scale-110 hover:cosy:text-primary/80';

// 社交媒体链接样式
const socialLinksClass =
    'cosy:flex cosy:gap-4 cosy:mt-6 cosy:pt-4 cosy:border-t cosy:border-base-300';
const socialLinkClass =
    'cosy:btn cosy:btn-ghost cosy:btn-circle cosy:btn-sm cosy:text-base-content hover:cosy:text-primary hover:cosy:bg-primary/10';
---

<Card
    title={title}
    subtitle={description}
    compact={compact}
    background={background}
    class={customClasses}>
    <div class="cosy:space-y-0">
        {
            address && (
                <div class={contactItemClass}>
                    <MapPinIcon class={iconClass} />
                    <span class="cosy:text-base-content">{address}</span>
                </div>
            )
        }

        {
            email && (
                <div class={contactItemClass}>
                    <MailIcon class={iconClass} />
                    <Link
                        href={`mailto:${email}`}
                        variant="text"
                        noUnderline={false}>
                        {email}
                    </Link>
                </div>
            )
        }

        {
            facebook && (
                <div class={contactItemClass}>
                    <FacebookIcon class={iconClass} />
                    <Link
                        href={facebook}
                        external
                        variant="text"
                        noUnderline={false}>
                        Facebook
                    </Link>
                </div>
            )
        }

        {
            github && (
                <div class={contactItemClass}>
                    <GithubIcon class={iconClass} />
                    <Link
                        href={github}
                        external
                        variant="text"
                        noUnderline={false}>
                        GitHub
                    </Link>
                </div>
            )
        }

        {
            linkedin && (
                <div class={contactItemClass}>
                    <LinkedinIcon class={iconClass} />
                    <Link
                        href={linkedin}
                        external
                        variant="text"
                        noUnderline={false}>
                        LinkedIn
                    </Link>
                </div>
            )
        }

        {
            phone && (
                <div class={contactItemClass}>
                    <PhoneIcon class={iconClass} />
                    <Link
                        href={`tel:${phone}`}
                        variant="text"
                        noUnderline={false}>
                        {phone}
                    </Link>
                </div>
            )
        }

        {
            twitter && (
                <div class={contactItemClass}>
                    <TwitterIcon class={iconClass} />
                    <Link
                        href={twitter}
                        external
                        variant="text"
                        noUnderline={false}>
                        Twitter
                    </Link>
                </div>
            )
        }

        {
            website && (
                <div class={contactItemClass}>
                    <WebsiteIcon class={iconClass} />
                    <Link
                        href={website}
                        external
                        variant="text"
                        noUnderline={false}>
                        {website.replace(/^https?:\/\//, '')}
                    </Link>
                </div>
            )
        }
    </div>

    {
        Astro.slots.has('default') && (
            <div class="cosy:mt-4">
                <slot />
            </div>
        )
    }

    {
        (github ||
            twitter ||
            facebook ||
            linkedin ||
            wechatQR ||
            whatsappQR) && (
            <div class={socialLinksClass}>
                {github && (
                    <Link
                        href={github}
                        external
                        btn
                        circle
                        size="sm"
                        class={socialLinkClass}
                        aria-label="GitHub">
                        <GithubIcon />
                    </Link>
                )}
                {twitter && (
                    <Link
                        href={twitter}
                        external
                        btn
                        circle
                        size="sm"
                        class={socialLinkClass}
                        aria-label="Twitter">
                        <TwitterIcon />
                    </Link>
                )}
                {facebook && (
                    <Link
                        href={facebook}
                        external
                        btn
                        circle
                        size="sm"
                        class={socialLinkClass}
                        aria-label="Facebook">
                        <FacebookIcon />
                    </Link>
                )}
                {linkedin && (
                    <Link
                        href={linkedin}
                        external
                        btn
                        circle
                        size="sm"
                        class={socialLinkClass}
                        aria-label="LinkedIn">
                        <LinkedinIcon />
                    </Link>
                )}
                {wechatQR && (
                    <Link
                        href="#"
                        btn
                        circle
                        size="sm"
                        class={socialLinkClass}
                        hoverImage={wechatQR}
                        hoverImageAlt="微信二维码"
                        aria-label="微信">
                        <WechatIcon />
                    </Link>
                )}
                {whatsappQR && (
                    <Link
                        href="#"
                        btn
                        circle
                        size="sm"
                        class={socialLinkClass}
                        hoverImage={whatsappQR}
                        hoverImageAlt="WhatsApp 二维码"
                        aria-label="WhatsApp">
                        <WhatsappIcon />
                    </Link>
                )}
            </div>
        )
    }
</Card>
