---
/**
 * DocumentationLayoutç»„ä»¶
 * 
 * é€‚ç”¨äºæ–‡æ¡£é¡µé¢çš„å¸ƒå±€ï¼ŒåŒ…å«ä¾§è¾¹æ å¯¼èˆªå’Œç›®å½•
 * 
 * @example
 * ```astro
 * ---
 * import DocumentationLayout from '../layouts/DocumentationLayout.astro';
 * 
 * const sidebarItems = [
 *   { title: "å…¥é—¨", items: [
 *     { href: "/docs/getting-started", text: "å¿«é€Ÿå¼€å§‹" },
 *     { href: "/docs/installation", text: "å®‰è£…" }
 *   ]},
 *   { title: "ç»„ä»¶", items: [
 *     { href: "/docs/components/button", text: "Button æŒ‰é’®" },
 *     { href: "/docs/components/card", text: "Card å¡ç‰‡" }
 *   ]}
 * ];
 * ---
 * 
 * <DocumentationLayout 
 *   title="æ–‡æ¡£æ ‡é¢˜" 
 *   description="æ–‡æ¡£æè¿°"
 *   sidebarItems={sidebarItems}
 * >
 *   <h1>æ–‡æ¡£å†…å®¹</h1>
 *   <p>è¿™æ˜¯æ–‡æ¡£çš„ä¸»è¦å†…å®¹</p>
 * </DocumentationLayout>
 * ```
 * 
 * è‡ªå®šä¹‰é¡µè„šç¤ºä¾‹ï¼š
 * ```astro
 * <DocumentationLayout 
 *   title="æ–‡æ¡£æ ‡é¢˜" 
 *   description="æ–‡æ¡£æè¿°"
 *   sidebarItems={sidebarItems}
 *   footerSlogan="ç®€å•è€Œå¼ºå¤§çš„ç»„ä»¶åº“"
 *   footerInspirationalSlogan="è®©å¼€å‘æ›´åŠ æ„‰æ‚¦"
 *   footerSocialLinks={[
 *     "https://github.com/myorg/myrepo",
 *     "https://twitter.com/myorg"
 *   ]}
 *   footerProducts={[
 *     { name: "ç»„ä»¶åº“", href: "/components" },
 *     { name: "æ¨¡æ¿", href: "/templates" }
 *   ]}
 * >
 *   <h1>æ–‡æ¡£å†…å®¹</h1>
 *   <p>è¿™æ˜¯æ–‡æ¡£çš„ä¸»è¦å†…å®¹</p>
 * </DocumentationLayout>
 * ```
 * 
 * ç»„ä»¶æ”¯æŒå¤šç§é¡µè„šç›¸å…³çš„é…ç½®å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ä»¥ `footer` ä¸ºå‰ç¼€çš„å±æ€§æ¥è‡ªå®šä¹‰é¡µè„šçš„å†…å®¹å’Œé“¾æ¥ã€‚
 * æ‰€æœ‰è¿™äº›å‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œç»„ä»¶ä¼šä¸ºå¸¸ç”¨å‚æ•°æä¾›é»˜è®¤å€¼ã€‚
 */

import BaseLayout from './BaseLayout.astro';
import TableOfContents from '../components/TableOfContents.astro';
import Article from '../typography/Article.astro';
import Footer from './Footer.astro';
import Main from '../containers/Main.astro';

export interface SidebarItem {
  href: string;
  text: string;
  items?: SidebarItem[];
}

export interface SidebarSection {
  title: string;
  items: SidebarItem[];
}

export interface Props {
  /**
   * é¡µé¢æ ‡é¢˜
   */
  title: string;
  
  /**
   * é¡µé¢æè¿°
   */
  description?: string;
  
  /**
   * é¡µé¢å…³é”®è¯
   */
  keywords?: string;
  
  /**
   * ç½‘ç«™åç§°
   * @default "æ–‡æ¡£ä¸­å¿ƒ"
   */
  siteName?: string;
  
  /**
   * ä¾§è¾¹æ é¡¹ç›®
   */
  sidebarItems: SidebarSection[];
  
  /**
   * æ˜¯å¦æ˜¾ç¤ºç›®å½•
   * @default true
   */
  showTableOfContents?: boolean;
  
  /**
   * æ˜¯å¦æ˜¾ç¤ºé¡µçœ‰
   * @default true
   */
  showHeader?: boolean;
  
  /**
   * æ˜¯å¦æ˜¾ç¤ºé¡µè„š
   * @default true
   */
  showFooter?: boolean;
  
  /**
   * è‡ªå®šä¹‰å¤´éƒ¨å†…å®¹
   */
  head?: astroHTML.JSX.Element;
  
  /**
   * é¡µé¢ç±»å
   */
  class?: string;
  
  /**
   * ç±»ååˆ—è¡¨
   */
  'class:list'?: any;

  /**
   * é¡µè„šç›¸å…³é…ç½®
   */
  // Footer ç›¸å…³å‚æ•°
  /**
   * é¡µè„šæ ‡è¯­
   * @default "ä¼˜é›…ã€é«˜æ•ˆçš„ç»„ä»¶åº“"
   */
  footerSlogan?: string;
  
  /**
   * å…¬å¸åç§°
   * @default ä¸siteNameç›¸åŒ
   */
  footerCompany?: string;
  
  /**
   * ç‰ˆæƒä¿¡æ¯
   * @default "ä¿ç•™æ‰€æœ‰æƒåˆ©"
   */
  footerCopyright?: string;
  
  /**
   * é¡µè„šæ¨ªå¹…æ ‡è¯­
   * @default "æ„å»ºç¾å¥½çš„æ•°å­—ä½“éªŒ"
   */
  footerInspirationalSlogan?: string;
  
  /**
   * ICPå¤‡æ¡ˆå·
   */
  footerIcp?: string;
  
  /**
   * ç½‘ç«™Logo
   */
  footerLogo?: { src: string; alt: string };
  
  /**
   * äº§å“é“¾æ¥åˆ—è¡¨
   */
  footerProducts?: Array<{ name: string; href: string; external?: boolean }>;
  
  /**
   * å…³äºæˆ‘ä»¬é“¾æ¥
   * @default "/about"
   */
  footerAboutLink?: string;
  
  /**
   * è”ç³»æˆ‘ä»¬é“¾æ¥
   * @default "/contact"
   */
  footerContactLink?: string;
  
  /**
   * æœåŠ¡æ¡æ¬¾é“¾æ¥
   */
  footerTermsLink?: string;
  
  /**
   * éšç§æ”¿ç­–é“¾æ¥
   */
  footerPrivacyLink?: string;
  
  /**
   * ç¤¾äº¤åª’ä½“é“¾æ¥åˆ—è¡¨
   */
  footerSocialLinks?: string[];
  
  /**
   * å›¢é˜Ÿä»‹ç»é“¾æ¥
   */
  footerTeamLink?: string;
  
  /**
   * åŠ å…¥æˆ‘ä»¬é“¾æ¥
   */
  footerCareersLink?: string;
  
  /**
   * æ–°é—»åŠ¨æ€é“¾æ¥
   */
  footerNewsLink?: string;
  
  /**
   * å‘å±•å†ç¨‹é“¾æ¥
   */
  footerHistoryLink?: string;
  
  /**
   * åˆä½œä¼™ä¼´é“¾æ¥
   */
  footerPartnersLink?: string;
  
  /**
   * æŠ€æœ¯åšå®¢é“¾æ¥
   */
  footerBlogLink?: string;
  
  /**
   * å¸¸è§é—®é¢˜é“¾æ¥
   */
  footerFaqLink?: string;
  
  /**
   * åª’ä½“æŠ¥é“é“¾æ¥
   */
  footerMediaLink?: string;
  
  /**
   * æŠ€æœ¯æ ˆé“¾æ¥
   */
  footerTechStackLink?: string;
}

const {
  title,
  description,
  keywords,
  siteName = "æ–‡æ¡£ä¸­å¿ƒ",
  sidebarItems,
  showTableOfContents = true,
  showHeader = true,
  showFooter = true,
  head,
  class: className,
  'class:list': classList,
  footerSlogan,
  footerCompany,
  footerCopyright,
  footerInspirationalSlogan,
  footerIcp,
  footerLogo,
  footerProducts,
  footerAboutLink,
  footerContactLink,
  footerTermsLink,
  footerPrivacyLink,
  footerSocialLinks,
  footerTeamLink,
  footerCareersLink,
  footerNewsLink,
  footerHistoryLink,
  footerPartnersLink,
  footerBlogLink,
  footerFaqLink,
  footerMediaLink,
  footerTechStackLink,
  ...rest
} = Astro.props;

const year = new Date().getFullYear();
const currentPath = Astro.url.pathname;
---

<BaseLayout 
  title={title} 
  description={description} 
  keywords={keywords}
  head={head}
  class="documentation-layout"
  {...rest}
>
  {showHeader && (
    <header class="site-header">
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <a href="/" class="site-name">{siteName}</a>
          </div>
          
          <div class="header-actions">
            <a href="#" class="search-button">
              <span class="search-icon">ğŸ”</span>
              <span class="search-text">æœç´¢æ–‡æ¡£...</span>
              <span class="search-shortcut">âŒ˜K</span>
            </a>
          </div>
        </div>
      </div>
    </header>
  )}
  
  <div class="documentation-container">
    <aside class="sidebar">
      <nav class="sidebar-nav">
        {sidebarItems.map((section: SidebarSection) => (
          <div class="sidebar-section">
            <h3 class="sidebar-title">{section.title}</h3>
            <ul class="sidebar-items">
              {section.items.map((item: SidebarItem) => {
                const isActive = currentPath === item.href;
                return (
                  <li class="sidebar-item">
                    <a 
                      href={item.href} 
                      class:list={["sidebar-link", { active: isActive }]}
                    >
                      {item.text}
                    </a>
                    {item.items && (
                      <ul class="sidebar-subitems">
                        {item.items.map((subitem: SidebarItem) => {
                          const isSubActive = currentPath === subitem.href;
                          return (
                            <li class="sidebar-subitem">
                              <a 
                                href={subitem.href} 
                                class:list={["sidebar-sublink", { active: isSubActive }]}
                              >
                                {subitem.text}
                              </a>
                            </li>
                          );
                        })}
                      </ul>
                    )}
                  </li>
                );
              })}
            </ul>
          </div>
        ))}
      </nav>
    </aside>
    
    <Main class="content" verticalPadding="2rem" size="xl">
      <div class="content-container">
        <Article class="doc-article">
          <slot />
        </Article>
        
        {showTableOfContents && (
          <div class="toc-container">
            <div class="toc-sticky">
              <slot name="toc">
                <TableOfContents />
              </slot>
            </div>
          </div>
        )}
      </div>
    </Main>
  </div>
  
  {showFooter && (
    <Footer 
      siteName={siteName}
      homeLink="/"
      slogan={footerSlogan || "ä¼˜é›…ã€é«˜æ•ˆçš„ç»„ä»¶åº“"}
      company={footerCompany || siteName}
      copyright={footerCopyright || "ä¿ç•™æ‰€æœ‰æƒåˆ©"}
      inspirationalSlogan={footerInspirationalSlogan || "æ„å»ºç¾å¥½çš„æ•°å­—ä½“éªŒ"}
      aboutLink={footerAboutLink || "/about"}
      contactLink={footerContactLink || "/contact"}
      icp={footerIcp}
      logo={footerLogo}
      products={footerProducts}
      termsLink={footerTermsLink}
      privacyLink={footerPrivacyLink}
      socialLinks={footerSocialLinks}
      teamLink={footerTeamLink}
      careersLink={footerCareersLink}
      newsLink={footerNewsLink}
      historyLink={footerHistoryLink}
      partnersLink={footerPartnersLink}
      blogLink={footerBlogLink}
      faqLink={footerFaqLink}
      mediaLink={footerMediaLink}
      techStackLink={footerTechStackLink}
    />
  )}
</BaseLayout>

<style>
  /* é¢œè‰²å˜é‡ */
  :root {
    --doc-bg-color: #ffffff;
    --doc-text-color: #333333;
    --doc-border-color: #eaeaea;
    --doc-sidebar-bg: #f9fafb;
    --doc-header-bg: #ffffff;
    --doc-link-color: #4b5563;
    --doc-link-hover-bg: rgba(0, 0, 0, 0.05);
    --doc-link-active-bg: rgba(59, 130, 246, 0.1);
    --doc-link-active-color: #2563eb;
    --doc-search-bg: #f9fafb;
    --doc-search-border: #eaeaea;
    --doc-search-text: #666666;
    --doc-search-shortcut-bg: #eaeaea;
    --doc-sidebar-title: #6b7280;
    --doc-sidebar-sublink: #6b7280;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --doc-bg-color: #121212;
      --doc-text-color: #e0e0e0;
      --doc-border-color: #2a2a2a;
      --doc-sidebar-bg: #1a1a1a;
      --doc-header-bg: #1a1a1a;
      --doc-link-color: #a0a0a0;
      --doc-link-hover-bg: rgba(255, 255, 255, 0.05);
      --doc-link-active-bg: rgba(59, 130, 246, 0.15);
      --doc-link-active-color: #60a5fa;
      --doc-search-bg: #2a2a2a;
      --doc-search-border: #3a3a3a;
      --doc-search-text: #a0a0a0;
      --doc-search-shortcut-bg: #3a3a3a;
      --doc-sidebar-title: #a0a0a0;
      --doc-sidebar-sublink: #909090;
    }
  }
  
  /* åŸºç¡€å¸ƒå±€ */
  .documentation-layout {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    background-color: var(--doc-bg-color);
    color: var(--doc-text-color);
  }
  
  .container {
    width: 100%;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 1rem;
  }
  
  /* é¡µçœ‰æ ·å¼ */
  .site-header {
    border-bottom: 1px solid var(--doc-border-color);
    background-color: var(--doc-header-bg);
    padding: 1rem 0;
    position: sticky;
    top: 0;
    z-index: 10;
  }
  
  .header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .site-name {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--doc-text-color);
  }
  
  .search-button {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border: 1px solid var(--doc-search-border);
    border-radius: 0.5rem;
    background-color: var(--doc-search-bg);
    color: var(--doc-search-text);
    font-size: 0.875rem;
  }
  
  .search-shortcut {
    padding: 0.125rem 0.375rem;
    background-color: var(--doc-search-shortcut-bg);
    border-radius: 0.25rem;
    font-size: 0.75rem;
  }
  
  /* æ–‡æ¡£å®¹å™¨ */
  .documentation-container {
    display: flex;
    flex: 1;
  }
  
  /* ä¾§è¾¹æ  */
  .sidebar {
    width: 280px;
    border-right: 1px solid var(--doc-border-color);
    background-color: var(--doc-sidebar-bg);
    padding: 1.5rem 0;
    overflow-y: auto;
    position: sticky;
    top: 65px;
    height: calc(100vh - 65px);
  }
  
  .sidebar-nav {
    padding: 0 1rem;
  }
  
  .sidebar-section {
    margin-bottom: 1.5rem;
  }
  
  .sidebar-title {
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    color: var(--doc-sidebar-title);
    margin-bottom: 0.75rem;
    padding: 0 0.5rem;
  }
  
  .sidebar-items {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .sidebar-item {
    margin-bottom: 0.25rem;
  }
  
  .sidebar-link {
    display: block;
    padding: 0.5rem;
    border-radius: 0.375rem;
    color: var(--doc-link-color);
    text-decoration: none;
    font-size: 0.9375rem;
  }
  
  .sidebar-link:hover {
    background-color: var(--doc-link-hover-bg);
  }
  
  .sidebar-link.active {
    background-color: var(--doc-link-active-bg);
    color: var(--doc-link-active-color);
    font-weight: 500;
  }
  
  .sidebar-subitems {
    list-style: none;
    padding-left: 1rem;
    margin: 0.25rem 0 0.5rem;
  }
  
  .sidebar-sublink {
    display: block;
    padding: 0.375rem 0.5rem;
    border-radius: 0.375rem;
    color: var(--doc-sidebar-sublink);
    text-decoration: none;
    font-size: 0.875rem;
  }
  
  .sidebar-sublink:hover {
    background-color: var(--doc-link-hover-bg);
  }
  
  .sidebar-sublink.active {
    color: var(--doc-link-active-color);
    font-weight: 500;
  }
  
  /* å†…å®¹åŒºåŸŸ */
  .content {
    flex: 1;
  }
  
  .content-container {
    display: flex;
    max-width: 1000px;
    margin: 0 auto;
    gap: 2rem;
  }
  
  .doc-article {
    flex: 1;
    min-width: 0;
    padding: 0 1rem;
  }
  
  /* ç›®å½• */
  .toc-container {
    width: 240px;
    display: none;
  }
  
  .toc-sticky {
    position: sticky;
    top: 5rem;
  }
  
  .toc-title {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--doc-sidebar-title);
  }
  
  /* å“åº”å¼è°ƒæ•´ */
  @media (min-width: 1024px) {
    .toc-container {
      display: block;
    }
  }
  
  @media (max-width: 768px) {
    .documentation-container {
      flex-direction: column;
    }
    
    .sidebar {
      width: 100%;
      position: static;
      height: auto;
      border-right: none;
      border-bottom: 1px solid var(--doc-border-color);
    }
    
    .content-container {
      flex-direction: column;
    }
  }
</style> 
