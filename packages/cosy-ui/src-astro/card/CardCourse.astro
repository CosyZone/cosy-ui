---
/**
 * @component CardCourse
 *
 * @description
 * è¯¾ç¨‹å¡ç‰‡ç»„ä»¶ï¼Œç”¨äºå±•ç¤ºè¯¾ç¨‹ä¿¡æ¯ï¼Œå…·æœ‰ç»Ÿä¸€çš„è®¾è®¡é£æ ¼ã€‚æ”¯æŒåŠ¨æ€å›¾æ ‡å’Œæ¸å˜èƒŒæ™¯ã€‚
 *
 * @usage
 * ```astro
 * <CardCourse courseName="React åŸºç¡€æ•™ç¨‹" courseSlug="react" lang="zh" href="/courses/react-basics" />
 * ```
 *
 * @props
 * - courseName: string - è¯¾ç¨‹æ ‡é¢˜
 * - courseSlug: string - è¯¾ç¨‹å”¯ä¸€æ ‡è¯†ï¼ˆç”¨äºå›¾æ ‡å’ŒèƒŒæ™¯ï¼‰
 * - description?: string - è¯¾ç¨‹æè¿°
 * - lang: string - è¯­è¨€ï¼ˆ"en" æˆ– "zh"ï¼‰
 * - href: string - è¯¾ç¨‹é“¾æ¥
 */

import '../../style.ts';

interface Props {
  courseName: string;
  courseSlug: string;
  description?: string;
  lang: string;
  href: string;
}

const { courseName, courseSlug, description = '', lang, href } = Astro.props;

// å›¾æ ‡æ˜ å°„ï¼ˆç”¨ emoji æˆ– SVGï¼Œç¤ºä¾‹ç”¨ emojiï¼‰
const courseIconMap: Record<string, string> = {
  computer_networks: 'ğŸ–§',
  computer_organization: 'ğŸ–¥ï¸',
  operating_systems: 'ğŸ’»',
  data_structures: 'ğŸ—„ï¸',
  higher_mathematics: 'ğŸ“',
  linear_algebra: 'â—',
  probability_and_statistics: 'ğŸ“Š',
  vue: 'ğŸŸ©',
  php: 'ğŸ˜',
  javascript: 'ğŸŸ¨',
  java: 'â˜•',
  golang: 'ğŸ’™',
  swift_ui: 'ğŸ',
  docker: 'ğŸ³',
  flutter: 'ğŸ’™',
  astro: 'ğŸš€',
  caddy: 'ğŸ›¡ï¸',
  kong: 'ğŸ’',
  default: 'ğŸ“š',
};

const courseGradientMap: Record<string, string> = {
  computer_networks: 'cosy:from-primary/50 cosy:to-secondary/50',
  computer_organization: 'cosy:from-primary/50 cosy:to-accent/50',
  operating_systems: 'cosy:from-secondary/50 cosy:to-accent/50',
  data_structures: 'cosy:from-accent/50 cosy:to-primary/50',
  higher_mathematics: 'cosy:from-success/50 cosy:to-info/50',
  linear_algebra: 'cosy:from-info/50 cosy:to-success/50',
  probability_and_statistics: 'cosy:from-success/50 cosy:to-accent/50',
  vue: 'cosy:from-success/50 cosy:to-primary/50',
  php: 'cosy:from-secondary/50 cosy:to-accent/50',
  javascript: 'cosy:from-warning/50 cosy:to-error/50',
  java: 'cosy:from-error/50 cosy:to-warning/50',
  golang: 'cosy:from-info/50 cosy:to-primary/50',
  swift_ui: 'cosy:from-warning/50 cosy:to-error/50',
  docker: 'cosy:from-info/50 cosy:to-primary/50',
  flutter: 'cosy:from-primary/50 cosy:to-secondary/50',
  astro: 'cosy:from-secondary/50 cosy:to-accent/50',
  caddy: 'cosy:from-success/50 cosy:to-primary/50',
  kong: 'cosy:from-accent/50 cosy:to-secondary/50',
  default: 'cosy:from-neutral cosy:to-base-content',
};

function normalizeName(name: string) {
  return name.toLowerCase().replace(/[^a-z0-9]/g, '_');
}

const normalizedName = normalizeName(courseSlug);

// åŠ¨æ€é€‰æ‹©å›¾æ ‡
let courseIcon = courseIconMap[normalizedName] || '';
if (!courseIcon) {
  for (const key in courseIconMap) {
    if (key !== 'default' && normalizedName.includes(key)) {
      courseIcon = courseIconMap[key];
      break;
    }
  }
}
if (!courseIcon) courseIcon = courseIconMap.default;

// åŠ¨æ€é€‰æ‹©æ¸å˜
let courseGradient = courseGradientMap[normalizedName] || '';
if (!courseGradient) {
  for (const key in courseGradientMap) {
    if (key !== 'default' && normalizedName.includes(key)) {
      courseGradient = courseGradientMap[key];
      break;
    }
  }
}
if (!courseGradient) courseGradient = courseGradientMap.default;

// æ ‡é¢˜æ ¼å¼åŒ–
const displayName = courseName
  .replace(/_/g, ' ')
  .replace(/\b\w/g, (l) => l.toUpperCase());
---

<div
  class={`card cosy:shadow-lg hover:cosy:shadow-xl cosy:transition-all cosy:duration-300 hover:cosy:-translate-y-1 cosy:border-0 cosy:overflow-hidden cosy:bg-gradient-to-br ${courseGradient} cosy:relative`}>
  <!-- èƒŒæ™¯å›¾æ ‡ -->
  <div
    class="cosy:absolute cosy:top-2 cosy:right-2 cosy:opacity-30 cosy:text-5xl">
    {courseIcon}
  </div>
  <div class="card-body cosy:p-6 cosy:relative cosy:z-10">
    <!-- æ ‡é¢˜å’Œæè¿°åŒºåŸŸ -->
    <div class="cosy:mb-4">
      <h3 class="cosy:text-lg cosy:font-semibold cosy:truncate cosy:text-start">
        {displayName}
      </h3>
      {
        description && (
          <p class="cosy:text-sm cosy:mt-4 cosy:line-clamp-3 cosy:text-start">
            {description}
          </p>
        )
      }
    </div>
    <!-- æ“ä½œæŒ‰é’® -->
    <div class="card-actions cosy:justify-end cosy:mt-4">
      <a
        href={href}
        class="btn cosy:bg-base-100 cosy:backdrop-blur-sm cosy:border cosy:border-base-100/30 hover:cosy:bg-base-100/30 cosy:transition-all cosy:duration-300">
        {lang === 'en' ? 'Start Learning' : 'å¼€å§‹å­¦ä¹ '}
      </a>
    </div>
  </div>
</div>
