---
/**
 * @component Button
 *
 * @description
 * Button ç»„ä»¶ç”¨äºè§¦å‘ä¸€ä¸ªå³æ—¶æ“ä½œï¼Œå¦‚è¡¨å•æäº¤ã€æ‰“å¼€å¯¹è¯æ¡†ç­‰ã€‚
 * æ”¯æŒå¤šç§æ ·å¼å˜ä½“ã€å°ºå¯¸å’ŒçŠ¶æ€ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ã€‚
 *
 * @design
 * è®¾è®¡ç†å¿µï¼š
 * 1. ç›´è§‚æ˜“ç”¨ - é€šè¿‡è§†è§‰å·®å¼‚æ¸…æ™°ä¼ è¾¾æŒ‰é’®çš„é‡è¦æ€§å’ŒåŠŸèƒ½
 * 2. å“åº”å¼äº¤äº’ - æä¾›ä¸°å¯Œçš„çŠ¶æ€åé¦ˆï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒ
 * 3. å¯å®šåˆ¶æ€§ - æ”¯æŒå¤šç§é…ç½®é€‰é¡¹ï¼Œé€‚åº”ä¸åŒåœºæ™¯éœ€æ±‚
 * 4. æ— éšœç¢æ€§ - ç¡®ä¿æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½è·å¾—è‰¯å¥½ä½“éªŒ
 *
 * è§†è§‰ç‰¹ç‚¹ï¼š
 * - æ‚¬åœæ•ˆæœï¼šè½»å¾®ä¸Šæµ®å’Œé˜´å½±å¢å¼º
 * - ç‚¹å‡»æ•ˆæœï¼šè½»å¾®ä¸‹æ²‰
 * - åŠ è½½çŠ¶æ€ï¼šæ˜¾ç¤ºåŠ è½½åŠ¨ç”»
 * - å¤šç§é¢œè‰²å˜ä½“ï¼šé€‚åº”ä¸åŒåœºæ™¯å’Œè¯­ä¹‰
 * - å¤šç§å°ºå¯¸ï¼šé€‚åº”ä¸åŒå¸ƒå±€éœ€æ±‚
 *
 * @usage
 * åŸºæœ¬ç”¨æ³•ï¼š
 * ```astro
 * <Button>é»˜è®¤æŒ‰é’®</Button>
 * <Button variant="primary">ä¸»è¦æŒ‰é’®</Button>
 * ```
 *
 * ä¸åŒå°ºå¯¸ï¼š
 * ```astro
 * <Button size="sm">å°å‹æŒ‰é’®</Button>
 * <Button size="lg">å¤§å‹æŒ‰é’®</Button>
 * ```
 *
 * çŠ¶æ€å˜åŒ–ï¼š
 * ```astro
 * <Button disabled>ç¦ç”¨æŒ‰é’®</Button>
 * <Button loading>åŠ è½½ä¸­</Button>
 * ```
 *
 * å¸¦å›¾æ ‡ï¼š
 * ```astro
 * <Button>
 *   <span slot="icon-left">ğŸ‘ˆ</span>
 *   å·¦ä¾§å›¾æ ‡
 * </Button>
 * ```
 *
 * é“¾æ¥æŒ‰é’®ï¼š
 * ```astro
 * <Button href="https://example.com">è·³è½¬é“¾æ¥</Button>
 * <Button href="https://example.com" target="_blank">æ–°çª—å£æ‰“å¼€</Button>
 * ```
 */

// å¯¼å…¥æ ·å¼
import '../../style.ts';

interface Props {
  variant?:
    | 'primary'
    | 'secondary'
    | 'accent'
    | 'info'
    | 'success'
    | 'warning'
    | 'error'
    | 'ghost'
    | 'link'
    | 'outline'
    | 'neutral';
  size?: 'lg' | 'md' | 'sm' | 'xs';
  shape?: 'circle' | 'square';
  wide?: boolean;
  block?: boolean;
  loading?: boolean;
  disabled?: boolean;
  type?: 'button' | 'submit' | 'reset';
  class?: string;
  onClick?: string;
  formmethod?: string;
  href?: string;
  target?: string;
  [key: string]: any; // å…è®¸ä»»æ„è‡ªå®šä¹‰å±æ€§
}

const {
  variant = 'primary',
  size = 'md',
  shape,
  wide = false,
  block = false,
  loading = false,
  disabled = false,
  type = 'button',
  class: className,
  onClick,
  formmethod,
  href,
  target,
  ...rest
} = Astro.props;

// è®¡ç®—æŒ‰é’®çš„ç±»å
const getButtonClasses = () => {
  const classes = ['cosy:btn'];

  // Variant classes
  const variantClasses = {
    primary: 'cosy:btn-primary',
    secondary: 'cosy:btn-secondary',
    accent: 'cosy:btn-accent',
    info: 'cosy:btn-info',
    success: 'cosy:btn-success',
    warning: 'cosy:btn-warning',
    error: 'cosy:btn-error',
    ghost: 'cosy:btn-ghost',
    link: 'cosy:btn-link',
    outline: 'cosy:btn-outline',
    neutral: 'cosy:btn-neutral',
  };

  // Size classes
  const sizeClasses = {
    lg: 'cosy:btn-lg',
    md: 'cosy:btn-md',
    sm: 'cosy:btn-sm',
    xs: 'cosy:btn-xs',
  };

  // Shape classes
  const shapeClasses = {
    circle: 'cosy:btn-circle',
    square: 'cosy:btn-square',
  };

  if (variantClasses[variant]) {
    classes.push(variantClasses[variant]);
  }

  if (sizeClasses[size]) {
    classes.push(sizeClasses[size]);
  }

  if (shape && shapeClasses[shape]) {
    classes.push(shapeClasses[shape]);
  }

  if (wide) classes.push('cosy:btn-wide');
  if (block) classes.push('cosy:btn-block');
  if (loading) classes.push('cosy:loading');
  if (className) classes.push(className);

  return classes;
};

const buttonClasses = getButtonClasses();
---

{
  href ? (
    <a
      href={href}
      class:list={buttonClasses}
      target={target}
      onclick={onClick}
      data-variant={variant}
      {...rest}>
      <span class="cosy:flex cosy:items-center cosy:gap-2">
        <slot name="icon-left" />
        <slot />
        <slot name="icon-right" />
      </span>
    </a>
  ) : (
    <button
      type={formmethod === 'dialog' ? 'submit' : type}
      class:list={buttonClasses}
      disabled={disabled}
      onclick={onClick}
      formmethod={formmethod}
      data-variant={variant}
      {...rest}>
      <span class="cosy:flex cosy:items-center cosy:gap-2">
        <slot name="icon-left" />
        <slot />
        <slot name="icon-right" />
      </span>
    </button>
  )
}
