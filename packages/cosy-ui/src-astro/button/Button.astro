---
/**
 * @component Button
 *
 * @description
 * Button ç»„ä»¶ç”¨äºè§¦å‘ä¸€ä¸ªå³æ—¶æ“ä½œï¼Œå¦‚è¡¨å•æäº¤ã€æ‰“å¼€å¯¹è¯æ¡†ç­‰ã€‚
 * æ”¯æŒå¤šç§æ ·å¼å˜ä½“ã€å°ºå¯¸å’ŒçŠ¶æ€ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ã€‚
 *
 * @usage
 * åŸºæœ¬ç”¨æ³•ï¼š
 * ```astro
 * <Button>é»˜è®¤æŒ‰é’®</Button>
 * <Button variant="primary">ä¸»è¦æŒ‰é’®</Button>
 * ```
 *
 * ä¸åŒå°ºå¯¸ï¼š
 * ```astro
 * <Button size="sm">å°å‹æŒ‰é’®</Button>
 * <Button size="lg">å¤§å‹æŒ‰é’®</Button>
 * ```
 *
 * çŠ¶æ€å˜åŒ–ï¼š
 * ```astro
 * <Button disabled>ç¦ç”¨æŒ‰é’®</Button>
 * <Button loading>åŠ è½½ä¸­</Button>
 * ```
 *
 * å¸¦å›¾æ ‡ï¼š
 * ```astro
 * <Button>
 *   <span slot="icon-left">ğŸ‘ˆ</span>
 *   å·¦ä¾§å›¾æ ‡
 * </Button>
 * ```
 *
 * é“¾æ¥æŒ‰é’®ï¼š
 * ```astro
 * <Button href="https://example.com">è·³è½¬é“¾æ¥</Button>
 * <Button href="https://example.com" target="_blank">æ–°çª—å£æ‰“å¼€</Button>
 * ```
 *
 * @props
 * @prop {boolean} [block=false] - æ˜¯å¦ä¸ºå—çº§æ˜¾ç¤ºï¼Œè®¾ç½®ä¸º true æ—¶æŒ‰é’®å æ»¡å®¹å™¨å®½åº¦
 * @prop {string} [class] - è‡ªå®šä¹‰ CSS ç±»åï¼Œç”¨äºè¦†ç›–é»˜è®¤æ ·å¼
 * @prop {boolean} [disabled=false] - æ˜¯å¦ç¦ç”¨æŒ‰é’®ï¼Œè®¾ç½®ä¸º true æ—¶æŒ‰é’®ä¸å¯ç‚¹å‡»
 * @prop {string} [formmethod] - è¡¨å•æäº¤æ–¹æ³•ï¼Œæ”¯æŒ dialog ç­‰ç‰¹æ®Šå€¼
 * @prop {string} [href] - é“¾æ¥åœ°å€ï¼Œè®¾ç½®åæŒ‰é’®å˜ä¸ºé“¾æ¥å½¢å¼
 * @prop {boolean} [loading=false] - æ˜¯å¦æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Œè®¾ç½®ä¸º true æ—¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
 * @prop {Function} [onClick] - ç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°
 * @prop {('circle'|'square')} [shape] - æŒ‰é’®å½¢çŠ¶ï¼Œæ”¯æŒ circleï¼ˆåœ†å½¢ï¼‰å’Œ squareï¼ˆæ–¹å½¢ï¼‰
 * @prop {('lg'|'md'|'sm'|'xs')} [size='md'] - æŒ‰é’®å°ºå¯¸ï¼Œæ”¯æŒ lgã€mdã€smã€xs å››ç§å°ºå¯¸
 * @prop {string} [target] - é“¾æ¥ç›®æ ‡ï¼Œæ”¯æŒ _selfã€_blankã€_parentã€_top
 * @prop {('button'|'submit'|'reset')} [type='button'] - æŒ‰é’®ç±»å‹ï¼Œæ”¯æŒ buttonã€submitã€reset
 * @prop {('primary'|'secondary'|'accent'|'info'|'success'|'warning'|'error'|'ghost'|'link'|'outline'|'neutral'|'gradient-sky'|'gradient-watermelon'|'gradient-lemon'|'gradient-grape'|'gradient-mango'|'gradient-forest'|'gradient-ocean'|'gradient-sunset'|'gradient-flower'|'gradient-pitaya'|'gradient-banana'|'gradient-blueberry'|'gradient-kiwi')} [variant='primary'] - æŒ‰é’®æ ·å¼å˜ä½“ï¼Œæ”¯æŒå¤šç§é¢„è®¾æ ·å¼å’Œæ¸å˜æ•ˆæœ
 * @prop {boolean} [wide=false] - æ˜¯å¦ä¸ºå®½æŒ‰é’®ï¼Œè®¾ç½®ä¸º true æ—¶æŒ‰é’®å®½åº¦å¢åŠ 
 *
 * @slots
 * @slot default - æŒ‰é’®å†…å®¹ï¼Œæ”¯æŒä»»æ„æ–‡æœ¬å†…å®¹
 * @slot icon-left - å·¦ä¾§å›¾æ ‡ï¼Œæ˜¾ç¤ºåœ¨æŒ‰é’®å†…å®¹å·¦ä¾§
 * @slot icon-right - å³ä¾§å›¾æ ‡ï¼Œæ˜¾ç¤ºåœ¨æŒ‰é’®å†…å®¹å³ä¾§
 */

import { cn } from '../../src/class';
import { getBaseButtonClasses } from '../../src/components/button/class-all';
import type { IButtonProps } from './props';

// ä» Astro.props è·å–å±æ€§
const props = Astro.props as IButtonProps;

const {
    block = false,
    class: className,
    disabled = false,
    formmethod,
    href,
    loading = false,
    onClick,
    shape,
    size = 'md',
    target,
    type = 'button',
    variant = 'primary',
    wide = false,
    ...rest
} = props;

// ä½¿ç”¨å…±ç”¨çš„å·¥å…·å‡½æ•°è®¡ç®—åŸºç¡€ç±»å
const baseButtonClasses = getBaseButtonClasses({
    variant,
    size,
    shape,
    wide,
    block,
    loading,
    class: className,
});

// åˆå¹¶æ‰€æœ‰ç±»å
const buttonClasses = baseButtonClasses.filter(Boolean).join(' ');

// ä½¿ç”¨ classBuilder æ„å»ºæŒ‰é’®å†…å®¹åŒºåŸŸçš„ç±»å
const buttonContentClass = cn().flex('row').items('center').gap(2).build();
---

{
    href ? (
        <a
            href={href}
            class={buttonClasses}
            target={target}
            onclick={
                onClick ? `${onClick.toString()}; return false;` : undefined
            }
            data-variant={variant}
            {...rest}>
            <span class={buttonContentClass}>
                <slot name="icon-left" />
                <slot />
                <slot name="icon-right" />
            </span>
        </a>
    ) : (
        <button
            type={formmethod === 'dialog' ? 'submit' : type}
            class={buttonClasses}
            disabled={disabled}
            onclick={
                onClick ? `${onClick.toString()}; return false;` : undefined
            }
            formmethod={formmethod}
            data-variant={variant}
            aria-label={rest['aria-label'] || 'æŒ‰é’®'}
            {...rest}>
            <span class={buttonContentClass}>
                <slot name="icon-left" />
                <slot />
                <slot name="icon-right" />
            </span>
        </button>
    )
}
