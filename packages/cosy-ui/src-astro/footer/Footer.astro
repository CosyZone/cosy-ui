---


/**
 * @component Footer
 *
 * @description
 * Footer 组件用于创建网站的页脚部分，提供版权信息、导航链接和社交媒体链接等内容。
 * 该组件支持高度自定义，可以根据需要显示或隐藏不同的部分。
 *
 * @design
 * 设计理念：
 * 1. 清晰的信息层次 - 通过视觉层次和分组展示不同类别的页脚信息
 * 2. 响应式布局 - 在不同屏幕尺寸下保持良好的可用性和美观性
 * 3. 可定制性 - 支持多种配置选项，适应不同网站的需求
 * 4. 品牌一致性 - 与网站整体设计风格保持一致
 * 5. 多语言支持 - 支持多种语言显示，自动检测当前语言环境
 *
 * 视觉特点：
 * - 分区布局：清晰区分不同类别的信息
 * - 简洁设计：使用适当的间距和字体大小确保可读性
 * - 品牌展示：突出显示网站名称和标语
 * - 社交媒体整合：提供社交媒体链接的展示
 *
 * @usage
 * 基本用法：
 * ```astro
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   inspirationalSlogan="构建美好的数字体验"
 * />
 * ```
 *
 * 添加社交媒体链接：
 * ```astro
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   inspirationalSlogan="构建美好的数字体验"
 *   socialLinks={[
 *     "https://github.com/myusername",
 *     "https://twitter.com/myusername"
 *   ]}
 * />
 * ```
 *
 * 添加微信二维码：
 * ```astro
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   inspirationalSlogan="构建美好的数字体验"
 *   wechatQR="/images/wechat-qr.png"
 * />
 * ```
 *
 * 使用本地图片作为微信二维码：
 * ```astro
 * import qrImage from '/images/wechat-qr.png';
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   inspirationalSlogan="构建美好的数字体验"
 *   wechatQR={qrImage}
 * />
 * ```
 *
 * 添加产品链接：
 * ```astro
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   inspirationalSlogan="构建美好的数字体验"
 *   products={[
 *     { name: "产品A", href: "/products/a" },
 *     { name: "产品B", href: "/products/b" }
 *   ]}
 * />
 * ```
 *
 * 添加友情链接：
 * ```astro
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   copyright="保留所有权利"
 *   inspirationalSlogan="构建美好的数字体验"
 *   friendlyLinks={[
 *     { name: "合作伙伴A", href: "https://partner-a.com" },
 *     { name: "合作伙伴B", href: "https://partner-b.com", external: true }
 *   ]}
 * />
 * ```
 *
 * 完整示例：
 * ```astro
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   copyright="保留所有权利"
 *   inspirationalSlogan="构建美好的数字体验"
 *   logo={{ src: "/logo.png", alt: "网站Logo" }}
 *   products={[
 *     { name: "产品A", href: "/products/a" },
 *     { name: "产品B", href: "/products/b" }
 *   ]}
 *   friendlyLinks={[
 *     { name: "合作伙伴A", href: "https://partner-a.com" },
 *     { name: "合作伙伴B", href: "https://partner-b.com", external: true }
 *   ]}
 *   socialLinks={[
 *     "https://github.com/myusername",
 *     "https://twitter.com/myusername"
 *   ]}
 *   aboutLink="/about"
 *   contactLink="/contact"
 *   termsLink="/terms"
 *   privacyLink="/privacy"
 * />
 * ```
 *
 * 指定语言：
 * ```astro
 * <Footer
 *   siteName="My Website"
 *   homeLink="/"
 *   slogan="Simple and Powerful"
 *   company="My Company"
 *   lang="en"
 * />
 * ```
 *
 * 自定义背景色：
 * ```astro
 * <Footer
 *   siteName="我的网站"
 *   homeLink="/"
 *   slogan="简单而强大"
 *   company="我的公司"
 *   background="primary/10"
 * />
 * ```
 *
 * @props
 * @prop {string} siteName - 网站名称
 * @prop {string} homeLink - 首页链接
 * @prop {string} slogan - 网站标语
 * @prop {string} company - 公司名称
 * @prop {string} inspirationalSlogan - 鼓舞人心的标语，显示在横幅中
 * @prop {BackgroundColor} [background='base-200'] - 背景色类型，支持所有预设背景色和透明度变体
 * @prop {Object} [logo] - 网站Logo对象，包含src和alt属性
 * @prop {Array<Object>} [products=[]] - 产品链接数组，每个对象包含name、href和可选的external属性
 * @prop {Array<Object>} [friendlyLinks=[]] - 友情链接数组，每个对象包含name、href和可选的external属性
 * @prop {Array<string>} [socialLinks=[]] - 社交媒体链接数组
 * @prop {ImageSource} [wechatQR] - 微信二维码图片源，支持本地图片或远程URL
 * @prop {ImageSource} [whatsappQR] - WhatsApp 二维码图片源，支持本地图片或远程URL
 * @prop {Object} [aboutInfo] - 关于信息配置，包含关于我们、联系我们、团队介绍、职业机会等链接
 * @prop {Object} [contactInfo] - 联系方式信息配置，包含地址、电话、邮箱、工作时间等详细信息
 * @prop {Object} [legalInfo] - 法律信息配置，包含服务条款、隐私政策、ICP备案等法律相关内容
 * @prop {Object} [resourcesInfo] - 资源信息配置，包含新闻、博客、常见问题、历史、技术栈等资源链接
 * @prop {string} [lang] - 语言代码，默认自动检测
 *
 * @accessibility
 * - 使用语义化HTML结构，确保屏幕阅读器可以正确解析
 * - 所有链接都有明确的文本描述
 * - 社交媒体图标包含屏幕阅读器专用的文本说明
 */

import {
    createTextGetter,
    type IFooterProps,
    LanguageUtil,
} from '../../index-astro';
import { cn } from '../../src/class';
import {
    type BackgroundColor,
    getBackgroundClass,
} from '../../src/common/backgrounds';
import { processSocialLink } from '../../src/utils/social';
import FooterBrand from './FooterBrand.astro';
import FooterCopyright from './FooterCopyright.astro';
import FooterICP from './FooterICP.astro';
import FooterNavigation from './FooterNavigation.astro';

const {
    siteName,
    homeLink,
    slogan,
    company,
    logo,
    products = [],
    friendlyLinks = [],
    socialLinks = [],
    wechatQR,
    whatsappQR,
    background = 'base-200',
    aboutInfo,
    contactInfo,
    legalInfo,
    resourcesInfo,
} = Astro.props as IFooterProps;

export type Props = IFooterProps;

// 获取当前语言
const lang = LanguageUtil.getCurrentLanguage(Astro);
// 创建文本获取函数
const t = createTextGetter(lang, 'footer');

// 处理社交链接
const processedSocialLinks = socialLinks.map((url) => processSocialLink(url));

// 获取背景色类名
const backgroundClass = getBackgroundClass(background as BackgroundColor);

// 使用 classBuilder 构建 footer 类名
const footerClass = cn()
    .add('cosy:footer')
    .flex()
    .add('cosy:flex-col', 'cosy:z-50', 'cosy:sm:footer-horizontal')
    .add('cosy:text-base-content', 'cosy:p-10')
    .add(backgroundClass)
    .build();

// 使用 classBuilder 构建容器类名
const containerClass = cn()
    .flex()
    .add('cosy:flex-col', 'cosy:md:h-64')
    .gap(8)
    .add('cosy:container', 'cosy:mx-auto')
    .items('center')
    .w('full')
    .add('cosy:md:flex-row', 'cosy:md:justify-between')
    .build();

// 使用 classBuilder 构建分隔线类名
const hrClass = cn().add('cosy:border-base-content/20', 'cosy:w-full').build();

// 使用 classBuilder 构建底部区域类名
const bottomClass = cn()
    .flex()
    .add('cosy:flex-col', 'cosy:items-center', 'cosy:justify-center')
    .w('full')
    .add('cosy:opacity-70', 'cosy:lg:flex-row', 'cosy:gap-4')
    .build();
---

<footer ignore-heading class={footerClass}>
    <div class={containerClass}>
        {/* 品牌区域 */}
        <FooterBrand
            siteName={siteName}
            homeLink={homeLink}
            slogan={slogan}
            logo={logo}
            socialLinks={processedSocialLinks}
            wechatQR={wechatQR}
            whatsappQR={whatsappQR}
        />

        {/* 导航区域 */}
        <FooterNavigation
            products={products}
            friendlyLinks={friendlyLinks}
            aboutInfo={aboutInfo}
            resourcesInfo={resourcesInfo}
            contactInfo={contactInfo}
            legalInfo={legalInfo}
            t={t}
        />
    </div>

    <hr class={hrClass} />

    <div class={bottomClass}>
        <FooterCopyright company={company} />

        {
            legalInfo?.icp && (
                <FooterICP icp={legalInfo.icp} icpLink={legalInfo.icpLink} />
            )
        }
    </div>
</footer>
