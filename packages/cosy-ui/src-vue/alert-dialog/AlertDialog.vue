<script setup lang="ts">
import "../../style";

/**
 * @component AlertDialog
 * @description AlertDialog 组件用于显示简单的确认对话框，支持国际化，带有淡入淡出动画效果。
 * @props
 * @prop {string} [class] - 自定义 CSS 类名，用于覆盖默认样式
 * @prop {boolean} modelValue - 控制对话框显示状态，支持v-model双向绑定
 * @prop {string} message - 对话框显示的消息内容
 * @prop {('zh-cn'|'en')} [lang='zh-cn'] - 语言设置，影响按钮文本
 * @emits
 * @emit {update:modelValue} - 当对话框关闭时触发，用于更新v-model绑定值
 */

type MessageKey = "confirm";

interface Messages {
	[key: string]: {
		[key in MessageKey]: string;
	};
}

interface Props {
	modelValue: boolean;
	message: string;
	lang?: "zh-cn" | "en";
	class?: string;
}

const props = withDefaults(defineProps<Props>(), {
	lang: "zh-cn",
	class: "",
});

const emit = defineEmits<{
	"update:modelValue": [value: boolean];
}>();

// 多语言文本
const t = (key: MessageKey) => {
	const messages: Messages = {
		"zh-cn": {
			confirm: "确定",
		},
		en: {
			confirm: "OK",
		},
	};
	return messages[props.lang][key];
};
</script>

<template>
    <Transition name="fade" class="cosy:transition-opacity cosy:duration-200 cosy:ease-in-out">
        <div v-if="modelValue" :class="[
            'cosy:fixed cosy:inset-0 cosy:z-50 cosy:flex cosy:items-center cosy:justify-center cosy:opacity-100 cosy:enter:opacity-0 cosy:leave:opacity-0',
            props.class
        ]">
            <!-- 背景遮罩 -->
            <div class="cosy:absolute cosy:inset-0 cosy:bg-base-200/80 cosy:backdrop-blur-sm"
                @click="emit('update:modelValue', false)"></div>

            <!-- 对话框 -->
            <div
                class="cosy:relative cosy:bg-base-100 cosy:rounded-xl cosy:shadow-lg cosy:w-[400px] cosy:transform cosy:transition-all">
                <!-- 内容区域 -->
                <div class="cosy:p-6">
                    <p class="cosy:text-base-content">
                        {{ props.message }}
                    </p>
                </div>

                <!-- 按钮区域 -->
                <div class="cosy:flex cosy:border-t cosy:border-base-300">
                    <button class="cosy:btn cosy:btn-ghost cosy:flex-1 cosy:rounded-none cosy:rounded-b-xl"
                        @click="emit('update:modelValue', false)">
                        {{ t('confirm') }}
                    </button>
                </div>
            </div>
        </div>
    </Transition>
</template>
